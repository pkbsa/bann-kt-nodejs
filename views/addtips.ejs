<!DOCTYPE html>
<html>
  <head>
    <title>Bann K&T Cattery</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="icon" href="./images/icon.png" type="image/png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit:wght@200&family=Titillium+Web:wght@300;900&family=Varela+Round&display=swap"
      rel="stylesheet"
    />

    <link href="addtips.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="./">Bann K&T Cattery</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarTogglerDemo02"
          aria-controls="navbarTogglerDemo02"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="./">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./admin">เพิ่มแมว</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./admin-parents">เพิ่มพ่อแม่</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="./admin-index">เพิ่มเกร็ดความรู้</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/logout">LOG OUT</a>
            </li>
          </ul>
          <div class="d-flex">
            <div class="row-nav">
              <i class="fa-brands fa-facebook fa-xl"></i>
              <a href="https://www.facebook.com/KwanRaweeCat">KwanRaweeCat</a>
              <i class="fa-solid fa-phone"></i>
              <a href="tel:081-919-6931">081 919 6931</a>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <div class="d-flex justify-content-center">
      <h1 class="title">Cat Dashboard</h1>
    </div>

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
      <path
        fill="#fff188"
        fill-opacity="1"
        d="M0,160L34.3,170.7C68.6,181,137,203,206,213.3C274.3,224,343,224,411,213.3C480,203,549,181,617,192C685.7,203,754,245,823,256C891.4,267,960,245,1029,229.3C1097.1,213,1166,203,1234,202.7C1302.9,203,1371,213,1406,218.7L1440,224L1440,0L1405.7,0C1371.4,0,1303,0,1234,0C1165.7,0,1097,0,1029,0C960,0,891,0,823,0C754.3,0,686,0,617,0C548.6,0,480,0,411,0C342.9,0,274,0,206,0C137.1,0,69,0,34,0L0,0Z"
      ></path>
    </svg>

    <div class="container4">
      <div class="container-1">
        <h1>เพิ่มเกร็ดความรู้  (<a href="./">Go</a>)</h1>
        <form action="/addtips" method="POST" enctype="multipart/form-data">
            <div class="col1">
              <label>Title :</label>
              <input type="text" name="title" required>
              <label>ข้อความ :</label>
              <TextArea name='text' rows="10" width="100%" required></TextArea>
            </div>
            <div class="col">
              <div class="image-preview" id="imagePreview">
                <img src="" alt="Image Preview" class="image-preview__image" />
                <span class="image-preview__default-text">Image Preview</span>
              </div>
              <input
                type="file"
                name="sampleFile"
                id="sampleFile"
                accept="image/*"
              /><br />
            </div>

          <div class="flex">
            <input type="submit" class="btn btn-success">
          </div>
        </form>
      </div>
      <h1 id="margin">เกร็ดความรู้</h1>
      <div class="accordion" id="accordionPanelsStayOpenExample">
        <% for (var t of tips){ %>
          <div class="accordion-item">
            <h2 class="accordion-header" id="panelsStayOpen-heading<%=t.id%>">
              <% if (t.id === 1) {%>
                <button class="accordion-button color" style="background-color: #fff188 ;color: #573A3E;" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapse<%=t.id%>" aria-expanded="true" aria-controls="panelsStayOpen-collapse<%=t.id%>">
                <%} else {%>
                  <button class="accordion-button collapsed color" style="background-color: #fff188 ;color: #573A3E;" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapse<%=t.id%>" aria-expanded="false" aria-controls="panelsStayOpen-collapse<%=t.id%>">
                <% } %>
                <%=t.title%>
              </button>
            </h2>
            <% if(t.id === 1){%>
            <div id="panelsStayOpen-collapse<%=t.id%>" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-heading<%=t.id%>">
            <%} else {%>
            <div id="panelsStayOpen-collapse<%=t.id%>" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-heading<%=t.id%>">  
            <% } %>
              <div class="accordion-body">
                <%- t.text.replace(/\n/g, '<br/>') %>
                <% if (t.image) { %>
                  <div class="pic">
                    <img id="pic" src="./images/index/slide/<%=t.image%>">
                  </div>
                <% } %>
                <div class="flex">
                  <button class="button edit" data-bs-toggle="modal" data-bs-target="#staticBackdrop<%=t.id%>">Edit</button>
                  <form action="/deletetip" method="POST">
                    <button class="button del" name="id" value="<%=t.id%>" type="submit">DELETE</button>
                  </form>
                </div>
                <div class="modal fade" id="staticBackdrop<%=t.id%>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">แก้ไขข้อมูล</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <form action="/updatetips" method="post" enctype="multipart/form-data">
                        <div class="modal-body">
                          <div class="col1">
                            <label>Title :</label>
                            <input type="text" name="title" value="<%=t.title%>"required>
                            <label>ข้อความ :</label>
                            <TextArea name='text' rows="10" width="100%" required><%=t.text%></TextArea>
                          </div>
                    
                          <div class="col">
                            <p style="color: red;">*หากไม่เปลี่ยนรูปไม่ต้องเลือก</p>
                            <input
                              type="file"
                              name="sampleFile"
                              id="sampleFile"
                              accept="image/*"
                            /><br />
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          <button type="submit" class="btn btn-primary" name="id" value="<%=t.id%>">Confirm</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% } %>
      </div>

    </div>
    <script>
      const inpFile = document.getElementById("sampleFile");
      const previewContainer = document.getElementById("imagePreview");
      const previewImage = previewContainer.querySelector(
        ".image-preview__image"
      );
      const previewDefaultText = previewContainer.querySelector(
        ".image-preview__default-text"
      );

      inpFile.addEventListener("change", function () {
        const file = this.files[0];

        if (file) {
          const reader = new FileReader();

          previewDefaultText.style.display = "none";
          previewImage.style.display = "block";

          reader.addEventListener("load", function () {
            previewImage.setAttribute("src", this.result);
          });

          reader.readAsDataURL(file);
        } else {
          previewDefaultText.style.display = null;
          previewImage.style.display = null;
          previewImage.setAttribute("src", "");
        }
      });
    </script>

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
      <path
        fill="#fff188"
        fill-opacity="1"
        d="M0,160L34.3,170.7C68.6,181,137,203,206,208C274.3,213,343,203,411,197.3C480,192,549,192,617,202.7C685.7,213,754,235,823,224C891.4,213,960,171,1029,144C1097.1,117,1166,107,1234,117.3C1302.9,128,1371,160,1406,176L1440,192L1440,320L1405.7,320C1371.4,320,1303,320,1234,320C1165.7,320,1097,320,1029,320C960,320,891,320,823,320C754.3,320,686,320,617,320C548.6,320,480,320,411,320C342.9,320,274,320,206,320C137.1,320,69,320,34,320L0,320Z"
      ></path>
    </svg>
    <footer>
      <p>© All rights reserved | <a href="/admin">pkbsa</a></p>
    </footer>

    <script
      src="https://kit.fontawesome.com/100c767ee6.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
